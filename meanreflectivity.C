{
auto tg_PENESRRef = new TGraph();
tg_PENESRRef->AddPoint(381.20754716981133, 27.71488469601677);
tg_PENESRRef->AddPoint(380.45283018867923, 22.68343815513627);
tg_PENESRRef->AddPoint(382.41509433962267, 36.60377358490566);
tg_PENESRRef->AddPoint(383.3207547169811, 46.16352201257862);
tg_PENESRRef->AddPoint(384.6792452830189, 55.55555555555556);
tg_PENESRRef->AddPoint(386.188679245283, 63.27044025157233);
tg_PENESRRef->AddPoint(387.54716981132077, 69.81132075471697);
tg_PENESRRef->AddPoint(389.9622641509434, 76.85534591194968);
tg_PENESRRef->AddPoint(392.9811320754717, 84.40251572327044);
tg_PENESRRef->AddPoint(395.24528301886795, 88.0922431865828);
tg_PENESRRef->AddPoint(397.9622641509434, 90.44025157232704);
tg_PENESRRef->AddPoint(400.9811320754717, 91.78197064989519);
tg_PENESRRef->AddPoint(404.60377358490564, 93.12368972746332);
tg_PENESRRef->AddPoint(409.7358490566038, 94.12997903563942);
tg_PENESRRef->AddPoint(412.90566037735846, 94.29769392033543);
tg_PENESRRef->AddPoint(417.7358490566038, 94.63312368972747);
tg_PENESRRef->AddPoint(421.35849056603774, 94.9685534591195);
tg_PENESRRef->AddPoint(425.1320754716981, 95.13626834381552);
tg_PENESRRef->AddPoint(428.90566037735846, 95.13626834381552);
tg_PENESRRef->AddPoint(433.4339622641509, 95.80712788259959);
tg_PENESRRef->AddPoint(438.1132075471698, 95.80712788259959);
tg_PENESRRef->AddPoint(442.188679245283, 95.80712788259959);
tg_PENESRRef->AddPoint(447.92452830188677, 96.14255765199162);
tg_PENESRRef->AddPoint(456.8301886792453, 96.31027253668763);
tg_PENESRRef->AddPoint(465.7358490566038, 96.81341719077568);
tg_PENESRRef->AddPoint(472.8301886792453, 96.47798742138365);
tg_PENESRRef->AddPoint(482.0377358490566, 96.9811320754717);

tg_PENESRRef->AddPoint(501, 97.0);

auto tg_PMTQE = new TGraph(); //https://hamamatsu.su/media/index/%3Ftype%3Dcatalog%26id%3D2&ved=2ahUKEwj788_UpMKHAxUuywIHHXl2MOEQFnoECBkQAQ&usg=AOvVaw3YgYwJulJerUMZFFa_FY5i
tg_PMTQE->AddPoint(274.87179487179486, 0.09849900773546232);
tg_PMTQE->AddPoint(283.0769230769231, 0.372759372031494);
tg_PMTQE->AddPoint(288.2051282051282, 1.4539905247440883);
tg_PMTQE->AddPoint(298.46153846153845, 3.340484983513244);
tg_PMTQE->AddPoint(305.64102564102564, 7.7915814643391785);
tg_PMTQE->AddPoint(317.94871794871796, 14.267615459606958);
tg_PMTQE->AddPoint(339.48717948717945, 21.140884460455894);
tg_PMTQE->AddPoint(374.35897435897436, 24.967366833985114);
tg_PMTQE->AddPoint(426.66666666666663, 24.967366833985114);
tg_PMTQE->AddPoint(485.1282051282051, 19.601189628919947);
tg_PMTQE->AddPoint(523.0769230769231, 14.485034710121479);
tg_PMTQE->AddPoint(547.6923076923076, 9.775698152536794);
tg_PMTQE->AddPoint(572.3076923076923, 6.498421570076716);
tg_PMTQE->AddPoint(590.7692307692307, 4.520353656360243);
tg_PMTQE->AddPoint(607.1794871794871, 2.7030588482581055);
tg_PMTQE->AddPoint(620.5128205128206, 1.743328822199988);
tg_PMTQE->AddPoint(640, 0.8563997244440057);
tg_PMTQE->AddPoint(656.4102564102564, 0.4676820901105864);
tg_PMTQE->AddPoint(667.6923076923076, 0.22974599398446502);
tg_PMTQE->AddPoint(680, 0.11116728815539267);
tg_PMTQE->AddPoint(691.2820512820513, 0.05628731194871122);
tg_PMTQE->AddPoint(702.5641025641025, 0.03027726099617869);

auto tg_PENESpec = new TGraph(); // from Gabriela's paper

tg_PENESpec->AddPoint(344.92099322799095, 0.01881720430107527*100.);
tg_PENESpec->AddPoint(355.30474040632055, 0.01881720430107527*100.);
tg_PENESpec->AddPoint(363.882618510158, 0.05376344086021506*100.);
tg_PENESpec->AddPoint(368.8487584650113, 0.12634408602150538*100.);
tg_PENESpec->AddPoint(371.1060948081264, 0.20698924731182797*100.);
tg_PENESpec->AddPoint(374.7178329571106, 0.2741935483870968*100.);
tg_PENESpec->AddPoint(378.3295711060948, 0.32795698924731187*100.);
tg_PENESpec->AddPoint(380.58690744920995, 0.40860215053763443*100.);
tg_PENESpec->AddPoint(384.65011286681715, 0.4919354838709678*100.);
tg_PENESpec->AddPoint(388.71331828442436, 0.5618279569892474*100.);
tg_PENESpec->AddPoint(390.9706546275395, 0.631720430107527*100.);
tg_PENESpec->AddPoint(394.13092550790066, 0.696236559139785*100.);
tg_PENESpec->AddPoint(396.83972911963883, 0.7580645161290324*100.);
tg_PENESpec->AddPoint(400.90293453724604, 0.7983870967741936*100.);
tg_PENESpec->AddPoint(406.32054176072234, 0.8521505376344086*100.);
tg_PENESpec->AddPoint(414.8984198645598, 0.8521505376344086*100.);
tg_PENESpec->AddPoint(421.2189616252822, 0.8467741935483871*100.);
tg_PENESpec->AddPoint(426.6365688487585, 0.7983870967741936*100.);
tg_PENESpec->AddPoint(431.60270880361173, 0.739247311827957*100.);
tg_PENESpec->AddPoint(435.66591422121894, 0.6935483870967742*100.);
tg_PENESpec->AddPoint(437.92325056433407, 0.6478494623655915*100.);
tg_PENESpec->AddPoint(441.98645598194133, 0.5913978494623656*100.);
tg_PENESpec->AddPoint(447.40406320541763, 0.5295698924731184*100.);
tg_PENESpec->AddPoint(452.8216704288939, 0.47580645161290325*100.);
tg_PENESpec->AddPoint(456.88487584650113, 0.4059139784946237*100.);
tg_PENESpec->AddPoint(463.6568848758465, 0.3413978494623656*100.);
tg_PENESpec->AddPoint(470.4288939051919, 0.28225806451612906*100.);
tg_PENESpec->AddPoint(481.2641083521445, 0.20967741935483872*100.);
tg_PENESpec->AddPoint(488.9390519187359, 0.1532258064516129*100.);
tg_PENESpec->AddPoint(499.32279909706546, 0.11021505376344087*100.);
tg_PENESpec->AddPoint(515.1241534988714, 0.07526881720430108*100.);
tg_PENESpec->AddPoint(528.6681715575621, 0.05376344086021506*100.);
tg_PENESpec->AddPoint(542.2121896162528, 0.043010752688172046*100.);
tg_PENESpec->AddPoint(551.2415349887133, 0.03763440860215054*100.);
tg_PENESpec->AddPoint(559.3679458239278, 0.05376344086021506*100.);
tg_PENESpec->AddPoint(570.6546275395034, 0.06451612903225806*100.);
tg_PENESpec->AddPoint(581.038374717833, 0.048387096774193554*100.);
tg_PENESpec->AddPoint(590.0677200902935, 0.03225806451612903*100.);
tg_PENESpec->AddPoint(602.7088036117382, 0.016129032258064516*100.);
tg_PENESpec->AddPoint(614.8984198645599, 0.024193548387096777*100.);

auto tg_PENESpec2 = new TGraph(); // from Andreas's measurement
tg_PENESpec2->AddPoint(339, 0);
tg_PENESpec2->AddPoint(359.44992947813824, 0);
tg_PENESpec2->AddPoint(363.89280677009873, 0.025210084033613467);
tg_PENESpec2->AddPoint(369.3229901269394, 0.07563025210084034);
tg_PENESpec2->AddPoint(375, 0.16806722689075632);
tg_PENESpec2->AddPoint(379.4428772919605, 0.3697478991596639);
tg_PENESpec2->AddPoint(383.638928067701, 0.6134453781512605);
tg_PENESpec2->AddPoint(386.60084626234135, 0.7899159663865546);
tg_PENESpec2->AddPoint(389.8095909732017, 1.004201680672269);
tg_PENESpec2->AddPoint(393.01833568406204, 1.2016806722689075);
tg_PENESpec2->AddPoint(395.73342736248236, 1.3991596638655461);
tg_PENESpec2->AddPoint(397.4612129760226, 1.5630252100840336);
tg_PENESpec2->AddPoint(400.1763046544429, 1.7436974789915967);
tg_PENESpec2->AddPoint(401.657263751763, 1.857142857142857);
tg_PENESpec2->AddPoint(403.6318758815233, 1.9873949579831933);
tg_PENESpec2->AddPoint(405.11283497884347, 2.0630252100840334);
tg_PENESpec2->AddPoint(406.10014104372357, 2.1176470588235294);
tg_PENESpec2->AddPoint(407.3342736248237, 2.184873949579832);
tg_PENESpec2->AddPoint(409.3088857545839, 2.23109243697479);
tg_PENESpec2->AddPoint(412.5176304654443, 2.264705882352941);
tg_PENESpec2->AddPoint(415.4795486600846, 2.2436974789915967);
tg_PENESpec2->AddPoint(416.9605077574048, 2.2142857142857144);
tg_PENESpec2->AddPoint(419.18194640338504, 2.176470588235294);
tg_PENESpec2->AddPoint(421.89703808180536, 2.134453781512605);
tg_PENESpec2->AddPoint(424.1184767277856, 2.084033613445378);
tg_PENESpec2->AddPoint(427.574047954866, 2.0252100840336134);
tg_PENESpec2->AddPoint(430.53596614950635, 1.9453781512605042);
tg_PENESpec2->AddPoint(433.00423131170663, 1.8697478991596639);
tg_PENESpec2->AddPoint(434.73201692524685, 1.7857142857142856);
tg_PENESpec2->AddPoint(436.459802538787, 1.7058823529411764);
tg_PENESpec2->AddPoint(438.68124118476726, 1.6260504201680672);
tg_PENESpec2->AddPoint(440.9026798307475, 1.5168067226890756);
tg_PENESpec2->AddPoint(443.86459802538786, 1.4327731092436973);
tg_PENESpec2->AddPoint(446.8265162200282, 1.315126050420168);
tg_PENESpec2->AddPoint(450.03526093088857, 1.1974789915966386);
tg_PENESpec2->AddPoint(452.99717912552893, 1.1050420168067228);
tg_PENESpec2->AddPoint(456.4527503526093, 1.004201680672269);
tg_PENESpec2->AddPoint(459.16784203102964, 0.9243697478991597);
tg_PENESpec2->AddPoint(462.37658674189, 0.8277310924369747);
tg_PENESpec2->AddPoint(466.8194640338505, 0.7142857142857143);
tg_PENESpec2->AddPoint(470.76868829337093, 0.6260504201680672);
tg_PENESpec2->AddPoint(475.21156558533147, 0.5462184873949579);
tg_PENESpec2->AddPoint(478.9139633286319, 0.4789915966386555);
tg_PENESpec2->AddPoint(483.11001410437234, 0.42016806722689076);
tg_PENESpec2->AddPoint(487.0592383638928, 0.36134453781512604);
tg_PENESpec2->AddPoint(491.99576868829337, 0.2899159663865546);
tg_PENESpec2->AddPoint(496.6854724964739, 0.23949579831932777);
tg_PENESpec2->AddPoint(503.10296191819464, 0.19747899159663868);
tg_PENESpec2->AddPoint(507.79266572637516, 0.1722689075630252);
tg_PENESpec2->AddPoint(513.7165021156559, 0.13025210084033617);
tg_PENESpec2->AddPoint(519.1466854724965, 0.1092436974789916);
tg_PENESpec2->AddPoint(527.5387870239774, 0.07142857142857145);
tg_PENESpec2->AddPoint(534.4499294781382, 0.06722689075630256);
tg_PENESpec2->AddPoint(541.361071932299, 0.054621848739495826);
tg_PENESpec2->AddPoint(546.7912552891396, 0.0378151260504202);

auto tg_PENESpec3 = new TGraph(); // from Sarthak's script3

tg_PENESpec3->AddPoint(302,  0.2041);
tg_PENESpec3->AddPoint(303,  0.2242);
tg_PENESpec3->AddPoint(304,  0.2443);
tg_PENESpec3->AddPoint(305,  0.2644);
tg_PENESpec3->AddPoint(306,  0.2845);
tg_PENESpec3->AddPoint(307,  0.2806);
tg_PENESpec3->AddPoint(308,  0.2695);
tg_PENESpec3->AddPoint(309,  0.2583);
tg_PENESpec3->AddPoint(310,  0.2471);
tg_PENESpec3->AddPoint(311,  0.2499);
tg_PENESpec3->AddPoint(312,  0.27);
tg_PENESpec3->AddPoint(313,  0.2901);
tg_PENESpec3->AddPoint(314,  0.3102);
tg_PENESpec3->AddPoint(315,  0.3303);
tg_PENESpec3->AddPoint(316,  0.3373);
tg_PENESpec3->AddPoint(317,  0.3373);
tg_PENESpec3->AddPoint(318,  0.3373);
tg_PENESpec3->AddPoint(319,  0.3373);
tg_PENESpec3->AddPoint(320,  0.3373);
tg_PENESpec3->AddPoint(321,  0.3459);
tg_PENESpec3->AddPoint(322,  0.3559);
tg_PENESpec3->AddPoint(323,  0.366);
tg_PENESpec3->AddPoint(324,  0.376);
tg_PENESpec3->AddPoint(325,  0.385);
tg_PENESpec3->AddPoint(326,  0.3738);
tg_PENESpec3->AddPoint(327,  0.3627);
tg_PENESpec3->AddPoint(328,  0.3515);
tg_PENESpec3->AddPoint(329,  0.3404);
tg_PENESpec3->AddPoint(330,  0.3373);
tg_PENESpec3->AddPoint(331,  0.3373);
tg_PENESpec3->AddPoint(332,  0.3373);
tg_PENESpec3->AddPoint(333,  0.3373);
tg_PENESpec3->AddPoint(334,  0.3373);
tg_PENESpec3->AddPoint(335,  0.328);
tg_PENESpec3->AddPoint(336,  0.318);
tg_PENESpec3->AddPoint(337,  0.308);
tg_PENESpec3->AddPoint(338,  0.2979);
tg_PENESpec3->AddPoint(339,  0.2879);
tg_PENESpec3->AddPoint(340,  0.2778);
tg_PENESpec3->AddPoint(341,  0.2678);
tg_PENESpec3->AddPoint(342,  0.2578);
tg_PENESpec3->AddPoint(343,  0.2477);
tg_PENESpec3->AddPoint(344,  0.2377);
tg_PENESpec3->AddPoint(345,  0.2277);
tg_PENESpec3->AddPoint(346,  0.2176);
tg_PENESpec3->AddPoint(347,  0.2076);
tg_PENESpec3->AddPoint(348,  0.1975);
tg_PENESpec3->AddPoint(349,  0.2045);
tg_PENESpec3->AddPoint(350,  0.2268);
tg_PENESpec3->AddPoint(351,  0.2491);
tg_PENESpec3->AddPoint(352,  0.2715);
tg_PENESpec3->AddPoint(353,  0.2892);
tg_PENESpec3->AddPoint(354,  0.2892);
tg_PENESpec3->AddPoint(355,  0.2892);
tg_PENESpec3->AddPoint(356,  0.2892);
tg_PENESpec3->AddPoint(357,  0.3014);
tg_PENESpec3->AddPoint(358,  0.3349);
tg_PENESpec3->AddPoint(359,  0.3684);
tg_PENESpec3->AddPoint(360,  0.4019);
tg_PENESpec3->AddPoint(361,  0.4414);
tg_PENESpec3->AddPoint(362,  0.5925);
tg_PENESpec3->AddPoint(363,  0.7367);
tg_PENESpec3->AddPoint(364,  0.8374);
tg_PENESpec3->AddPoint(365,  0.938);
tg_PENESpec3->AddPoint(366,  1.1134);
tg_PENESpec3->AddPoint(367,  1.497);
tg_PENESpec3->AddPoint(368,  1.8806);
tg_PENESpec3->AddPoint(369,  2.2642);
tg_PENESpec3->AddPoint(370,  2.6478);
tg_PENESpec3->AddPoint(371,  3.0314);
tg_PENESpec3->AddPoint(372,  3.415);
tg_PENESpec3->AddPoint(373,  3.874);
tg_PENESpec3->AddPoint(374,  4.3787);
tg_PENESpec3->AddPoint(375,  4.8817);
tg_PENESpec3->AddPoint(376,  5.3847);
tg_PENESpec3->AddPoint(377,  5.8877);
tg_PENESpec3->AddPoint(378,  6.3907);
tg_PENESpec3->AddPoint(379,  6.8937);
tg_PENESpec3->AddPoint(380,  7.3967);
tg_PENESpec3->AddPoint(381,  7.8996);
tg_PENESpec3->AddPoint(382,  8.4026);
tg_PENESpec3->AddPoint(383,  8.9065);
tg_PENESpec3->AddPoint(384,  9.4278);
tg_PENESpec3->AddPoint(385,  9.9948);
tg_PENESpec3->AddPoint(386,  10.5618);
tg_PENESpec3->AddPoint(387,  11.1288);
tg_PENESpec3->AddPoint(388,  11.6423);
tg_PENESpec3->AddPoint(389,  11.9539);
tg_PENESpec3->AddPoint(390,  12.507);
tg_PENESpec3->AddPoint(391,  13.2813);
tg_PENESpec3->AddPoint(392,  14.0556);
tg_PENESpec3->AddPoint(393,  14.7209);
tg_PENESpec3->AddPoint(394,  15.0243);
tg_PENESpec3->AddPoint(395,  15.4919);
tg_PENESpec3->AddPoint(396,  16.1876);
tg_PENESpec3->AddPoint(397,  16.9154);
tg_PENESpec3->AddPoint(398,  17.6433);
tg_PENESpec3->AddPoint(399,  18.3374);
tg_PENESpec3->AddPoint(400,  18.6408);
tg_PENESpec3->AddPoint(401,  18.9442);
tg_PENESpec3->AddPoint(402,  19.2927);
tg_PENESpec3->AddPoint(403,  19.7544);
tg_PENESpec3->AddPoint(404,  20.0918);
tg_PENESpec3->AddPoint(405,  20.3362);
tg_PENESpec3->AddPoint(406,  20.5633);
tg_PENESpec3->AddPoint(407,  20.749);
tg_PENESpec3->AddPoint(408,  20.9318);
tg_PENESpec3->AddPoint(409,  21.1146);
tg_PENESpec3->AddPoint(410,  21.2973);
tg_PENESpec3->AddPoint(411,  21.4801);
tg_PENESpec3->AddPoint(412,  21.6629);
tg_PENESpec3->AddPoint(413,  21.8457);
tg_PENESpec3->AddPoint(414,  21.994);
tg_PENESpec3->AddPoint(415,  22.0568);
tg_PENESpec3->AddPoint(416,  22.1197);
tg_PENESpec3->AddPoint(417,  22.1825);
tg_PENESpec3->AddPoint(418,  22.227);
tg_PENESpec3->AddPoint(419,  22.2493);
tg_PENESpec3->AddPoint(420,  22.2716);
tg_PENESpec3->AddPoint(421,  22.294);
tg_PENESpec3->AddPoint(422,  22.2997);
tg_PENESpec3->AddPoint(423,  22.1995);
tg_PENESpec3->AddPoint(424,  22.0994);
tg_PENESpec3->AddPoint(425,  21.9992);
tg_PENESpec3->AddPoint(426,  21.8531);
tg_PENESpec3->AddPoint(427,  21.6931);
tg_PENESpec3->AddPoint(428,  21.5259);
tg_PENESpec3->AddPoint(429,  21.346);
tg_PENESpec3->AddPoint(430,  21.166);
tg_PENESpec3->AddPoint(431,  20.6401);
tg_PENESpec3->AddPoint(432,  20.0959);
tg_PENESpec3->AddPoint(433,  19.8961);
tg_PENESpec3->AddPoint(434,  19.6977);
tg_PENESpec3->AddPoint(435,  19.5178);
tg_PENESpec3->AddPoint(436,  19.3378);
tg_PENESpec3->AddPoint(437,  19.0571);
tg_PENESpec3->AddPoint(438,  18.7008);
tg_PENESpec3->AddPoint(439,  18.2815);
tg_PENESpec3->AddPoint(440,  17.9495);
tg_PENESpec3->AddPoint(441,  17.6175);
tg_PENESpec3->AddPoint(442,  17.2916);
tg_PENESpec3->AddPoint(443,  16.9778);
tg_PENESpec3->AddPoint(444,  16.6639);
tg_PENESpec3->AddPoint(445,  16.35);
tg_PENESpec3->AddPoint(446,  16.0361);
tg_PENESpec3->AddPoint(447,  15.7222);
tg_PENESpec3->AddPoint(448,  15.4083);
tg_PENESpec3->AddPoint(449,  15.0945);
tg_PENESpec3->AddPoint(450,  14.7806);
tg_PENESpec3->AddPoint(451,  14.4667);
tg_PENESpec3->AddPoint(452,  14.2121);
tg_PENESpec3->AddPoint(453,  13.9874);
tg_PENESpec3->AddPoint(454,  13.6442);
tg_PENESpec3->AddPoint(455,  13.258);
tg_PENESpec3->AddPoint(456,  12.8718);
tg_PENESpec3->AddPoint(457,  12.4856);
tg_PENESpec3->AddPoint(458,  12.0994);
tg_PENESpec3->AddPoint(459,  11.7132);
tg_PENESpec3->AddPoint(460,  11.3271);
tg_PENESpec3->AddPoint(461,  10.9409);
tg_PENESpec3->AddPoint(462,  10.6574);
tg_PENESpec3->AddPoint(463,  10.4774);
tg_PENESpec3->AddPoint(464,  10.2855);
tg_PENESpec3->AddPoint(465,  9.9685);
tg_PENESpec3->AddPoint(466,  9.6514);
tg_PENESpec3->AddPoint(467,  9.3344);
tg_PENESpec3->AddPoint(468,  9.0174);
tg_PENESpec3->AddPoint(469,  8.7004);
tg_PENESpec3->AddPoint(470,  8.4542);
tg_PENESpec3->AddPoint(471,  8.2295);
tg_PENESpec3->AddPoint(472,  7.9426);
tg_PENESpec3->AddPoint(473,  7.6531);
tg_PENESpec3->AddPoint(474,  7.3788);
tg_PENESpec3->AddPoint(475,  7.1563);
tg_PENESpec3->AddPoint(476,  6.9963);
tg_PENESpec3->AddPoint(477,  6.8363);
tg_PENESpec3->AddPoint(478,  6.6763);
tg_PENESpec3->AddPoint(479,  6.5162);
tg_PENESpec3->AddPoint(480,  6.3152);
tg_PENESpec3->AddPoint(481,  6.0905);
tg_PENESpec3->AddPoint(482,  5.8973);
tg_PENESpec3->AddPoint(483,  5.7174);
tg_PENESpec3->AddPoint(484,  5.5413);
tg_PENESpec3->AddPoint(485,  5.3747);
tg_PENESpec3->AddPoint(486,  5.208);
tg_PENESpec3->AddPoint(487,  5.036);
tg_PENESpec3->AddPoint(488,  4.856);
tg_PENESpec3->AddPoint(489,  4.6761);
tg_PENESpec3->AddPoint(490,  4.5159);
tg_PENESpec3->AddPoint(491,  4.3559);
tg_PENESpec3->AddPoint(492,  4.2114);
tg_PENESpec3->AddPoint(493,  4.0779);
tg_PENESpec3->AddPoint(494,  3.9445);
tg_PENESpec3->AddPoint(495,  3.8341);
tg_PENESpec3->AddPoint(496,  3.734);
tg_PENESpec3->AddPoint(497,  3.6338);
tg_PENESpec3->AddPoint(498,  3.5282);
tg_PENESpec3->AddPoint(499,  3.4114);
tg_PENESpec3->AddPoint(500,  3.2946);
tg_PENESpec3->AddPoint(501,  3.196);
tg_PENESpec3->AddPoint(502,  3.1209);
tg_PENESpec3->AddPoint(503,  3.0457);
tg_PENESpec3->AddPoint(504,  2.9705);
tg_PENESpec3->AddPoint(505,  2.8659);
tg_PENESpec3->AddPoint(506,  2.7407);
tg_PENESpec3->AddPoint(507,  2.6488);
tg_PENESpec3->AddPoint(508,  2.5737);
tg_PENESpec3->AddPoint(509,  2.4985);
tg_PENESpec3->AddPoint(510,  2.4233);
tg_PENESpec3->AddPoint(511,  2.3277);
tg_PENESpec3->AddPoint(512,  2.2276);
tg_PENESpec3->AddPoint(513,  2.1274);
tg_PENESpec3->AddPoint(514,  2.0855);
tg_PENESpec3->AddPoint(515,  2.0478);
tg_PENESpec3->AddPoint(516,  2.0102);
tg_PENESpec3->AddPoint(517,  1.9701);
tg_PENESpec3->AddPoint(518,  1.9032);
tg_PENESpec3->AddPoint(519,  1.8364);
tg_PENESpec3->AddPoint(520,  1.7741);
tg_PENESpec3->AddPoint(521,  1.7295);
tg_PENESpec3->AddPoint(522,  1.6849);
tg_PENESpec3->AddPoint(523,  1.6404);
tg_PENESpec3->AddPoint(524,  1.5958);
tg_PENESpec3->AddPoint(525,  1.5463);
tg_PENESpec3->AddPoint(526,  1.4962);
tg_PENESpec3->AddPoint(527,  1.446);
tg_PENESpec3->AddPoint(528,  1.3961);
tg_PENESpec3->AddPoint(529,  1.3515);
tg_PENESpec3->AddPoint(530,  1.3069);
tg_PENESpec3->AddPoint(531,  1.2624);
tg_PENESpec3->AddPoint(532,  1.2178);
tg_PENESpec3->AddPoint(533,  1.1977);
tg_PENESpec3->AddPoint(534,  1.1877);
tg_PENESpec3->AddPoint(535,  1.1776);
tg_PENESpec3->AddPoint(536,  1.1676);
tg_PENESpec3->AddPoint(537,  1.1576);
tg_PENESpec3->AddPoint(538,  1.1339);
tg_PENESpec3->AddPoint(539,  1.1088);
tg_PENESpec3->AddPoint(540,  1.0837);
tg_PENESpec3->AddPoint(541,  1.0602);
tg_PENESpec3->AddPoint(542,  1.0602);
tg_PENESpec3->AddPoint(543,  1.0602);
tg_PENESpec3->AddPoint(544,  1.0602);
tg_PENESpec3->AddPoint(545,  1.0602);
tg_PENESpec3->AddPoint(546,  1.0353);
tg_PENESpec3->AddPoint(547,  1.0019);
tg_PENESpec3->AddPoint(548,  0.9684);
tg_PENESpec3->AddPoint(549,  0.935);
tg_PENESpec3->AddPoint(550,  0.921);
tg_PENESpec3->AddPoint(551,  0.9335);
tg_PENESpec3->AddPoint(552,  0.9461);
tg_PENESpec3->AddPoint(553,  0.9586);
tg_PENESpec3->AddPoint(554,  0.9873);
tg_PENESpec3->AddPoint(555,  1.0275);
tg_PENESpec3->AddPoint(556,  1.0677);
tg_PENESpec3->AddPoint(557,  1.1079);
tg_PENESpec3->AddPoint(558,  1.1481);
tg_PENESpec3->AddPoint(559,  1.183);
tg_PENESpec3->AddPoint(560,  1.2165);
tg_PENESpec3->AddPoint(561,  1.25);
tg_PENESpec3->AddPoint(562,  1.2835);
tg_PENESpec3->AddPoint(563,  1.3249);
tg_PENESpec3->AddPoint(564,  1.3752);
tg_PENESpec3->AddPoint(565,  1.4254);
tg_PENESpec3->AddPoint(566,  1.4757);
tg_PENESpec3->AddPoint(567,  1.5031);
tg_PENESpec3->AddPoint(568,  1.5174);
tg_PENESpec3->AddPoint(569,  1.5318);
tg_PENESpec3->AddPoint(570,  1.5461);
tg_PENESpec3->AddPoint(571,  1.5605);
tg_PENESpec3->AddPoint(572,  1.5748);
tg_PENESpec3->AddPoint(573,  1.5892);
tg_PENESpec3->AddPoint(574,  1.6035);
tg_PENESpec3->AddPoint(575,  1.6179);
tg_PENESpec3->AddPoint(576,  1.6322);
tg_PENESpec3->AddPoint(577,  1.6323);
tg_PENESpec3->AddPoint(578,  1.6212);
tg_PENESpec3->AddPoint(579,  1.61);
tg_PENESpec3->AddPoint(580,  1.5989);
tg_PENESpec3->AddPoint(581,  1.5754);
tg_PENESpec3->AddPoint(582,  1.5128);
tg_PENESpec3->AddPoint(583,  1.4501);
tg_PENESpec3->AddPoint(584,  1.3875);
tg_PENESpec3->AddPoint(585,  1.3157);
tg_PENESpec3->AddPoint(586,  1.2298);
tg_PENESpec3->AddPoint(587,  1.1439);
tg_PENESpec3->AddPoint(588,  1.059);
tg_PENESpec3->AddPoint(589,  1.0088);
tg_PENESpec3->AddPoint(590,  0.9587);
tg_PENESpec3->AddPoint(591,  0.9085);
tg_PENESpec3->AddPoint(592,  0.8638);
tg_PENESpec3->AddPoint(593,  0.8438);
tg_PENESpec3->AddPoint(594,  0.8237);
tg_PENESpec3->AddPoint(595,  0.8036);
tg_PENESpec3->AddPoint(596,  0.7836);
tg_PENESpec3->AddPoint(597,  0.7635);
tg_PENESpec3->AddPoint(598,  0.7434);
tg_PENESpec3->AddPoint(599,  0.7233);
tg_PENESpec3->AddPoint(600,  0.7033);
tg_PENESpec3->AddPoint(601,  0.6832);
tg_PENESpec3->AddPoint(602,  0.6651);
tg_PENESpec3->AddPoint(603,  0.6483);
tg_PENESpec3->AddPoint(604,  0.6316);
tg_PENESpec3->AddPoint(605,  0.6149);
tg_PENESpec3->AddPoint(606,  0.5982);
tg_PENESpec3->AddPoint(607,  0.5814);
tg_PENESpec3->AddPoint(608,  0.5647);
tg_PENESpec3->AddPoint(609,  0.548);
tg_PENESpec3->AddPoint(610,  0.5312);
tg_PENESpec3->AddPoint(611,  0.5093);
tg_PENESpec3->AddPoint(612,  0.487);
tg_PENESpec3->AddPoint(613,  0.4647);
tg_PENESpec3->AddPoint(614,  0.4424);
tg_PENESpec3->AddPoint(615,  0.4337);
tg_PENESpec3->AddPoint(616,  0.4337);
tg_PENESpec3->AddPoint(617,  0.4337);
tg_PENESpec3->AddPoint(618,  0.4337);
tg_PENESpec3->AddPoint(619,  0.4337);
tg_PENESpec3->AddPoint(620,  0.4337);
tg_PENESpec3->AddPoint(621,  0.4337);
tg_PENESpec3->AddPoint(622,  0.4337);
tg_PENESpec3->AddPoint(623,  0.4337);
tg_PENESpec3->AddPoint(624,  0.4435);
tg_PENESpec3->AddPoint(625,  0.4535);
tg_PENESpec3->AddPoint(626,  0.4636);
tg_PENESpec3->AddPoint(627,  0.4736);
tg_PENESpec3->AddPoint(628,  0.4802);
tg_PENESpec3->AddPoint(629,  0.4702);
tg_PENESpec3->AddPoint(630,  0.4601);
tg_PENESpec3->AddPoint(631,  0.4501);
tg_PENESpec3->AddPoint(632,  0.4401);
tg_PENESpec3->AddPoint(633,  0.4384);
tg_PENESpec3->AddPoint(634,  0.4509);
tg_PENESpec3->AddPoint(635,  0.4635);
tg_PENESpec3->AddPoint(636,  0.476);
tg_PENESpec3->AddPoint(637,  0.4674);
tg_PENESpec3->AddPoint(638,  0.44);
tg_PENESpec3->AddPoint(639,  0.4127);
tg_PENESpec3->AddPoint(640,  0.3853);
tg_PENESpec3->AddPoint(641,  0.3579);
tg_PENESpec3->AddPoint(642,  0.3405);
tg_PENESpec3->AddPoint(643,  0.353);
tg_PENESpec3->AddPoint(644,  0.3656);
tg_PENESpec3->AddPoint(645,  0.3781);
tg_PENESpec3->AddPoint(645.591,  0.3855);
// from Sarthaks script
int nenergies = 48;
vector<float> PEN_photon_energy = {0.1, 2.067,2.175,2.214,2.255,2.340,2.385,2.431,2.436,2.531,2.583,2.638,2.696,2.725,2.756,2.787,2.818,
2.884,2.918,2.952,2.988,3.024,3.039,3.047,3.054,3.062,3.069,3.077,3.085,3.092,3.100,3.108,3.116,3.123,3.131,3.139,3.147,3.155,
3.163,3.171,3.179,3.188,3.196,3.204,3.212,3.221,3.263, 8.0}; //energy in eV

vector<float> PEN_reflectance = {100.130, 100.130,99.995,99.856,99.681,99.659,99.569,99.351,99.306,99.018,98.652,98.415,98.283,
98.018,97.856,97.606,97.457,97.134,96.928,96.827,96.247,95.737,95.359,95.197,95.048,94.876,94.684,94.463,94.055,93.650,93.147,
92.562,91.812,90.904,89.807,88.506,86.957,85.242,83.156,80.678,77.811,74.615,71.004,67.089,62.924,58.670,20.000, 20.000}; // %cage reflectance
float PEN_wl[48];
float PEN_ref[48];
// wavelength_value = 1239.847/energy_value; nm, eV
float wavelengthToEnergy = 1239.847;
float ref_standard = 0.98;
for (int ibin = 0; ibin < nenergies; ibin++) {
	PEN_wl[ibin] = wavelengthToEnergy/PEN_photon_energy[ibin];
	PEN_ref[ibin] = PEN_reflectance[ibin]*ref_standard;
}
auto tg_PENRef2 = new TGraph(nenergies, PEN_wl, PEN_ref);

TH1D *hdummy = new TH1D("hdummy","",10,300,550);
hdummy->GetYaxis()->SetRangeUser(0, 100);
hdummy->Draw();

tg_PENESRRef->SetMarkerStyle(2);
tg_PENESRRef->Draw("sameP");

tg_PENRef2->SetMarkerStyle(5); tg_PENRef2->SetMarkerColor(8);
tg_PENRef2->Draw("sameP");
tg_PENESpec->SetMarkerStyle(3);
tg_PENESpec->Draw("sameP");
tg_PENESpec3->Draw("sameP");
tg_PMTQE->SetMarkerStyle(4);
tg_PMTQE->Draw("sameP");


TF1 *fgg = new TF1("fgg","[0]*([1]*TMath::Gaus(x,[2],[3],1) + (1.-[1])*TMath::Gaus(x,[4],[5],1))", 300, 600);
fgg->SetParameters(110.311, 0.507, 402, 19.67, 435.8, 28.3);
fgg->SetParLimits(1, 0.2, 0.8);
fgg->SetParLimits(2, 390, 410);
fgg->SetParLimits(3, 5, 50);
fgg->SetParLimits(4, 410, 450);
fgg->SetParLimits(5, 5, 50);
tg_PENESpec->Fit("fgg","","",340,480);

TF1 *fref = new TF1("fref","[0]/(1 + exp(-[1]*(x-[2])))",300, 600);
fref->SetParameters(94.759, 0.273, 284.);
fref->SetParLimits(2, 360, 410);
fgg->DrawCopy("same");
TF1 *fPMT = new TF1("fPMT","gaus",300,600);
tg_PENESRRef->Fit("fref","","",340, 440);

fgg->SetParameter(0, 1.); // normalize

float nsamples =40.;
float wstart = 340.;
float wend = 500;

float dw = (wend - wstart)/nsamples;

float averageR = 0.0, wl = 0.;
float norm = 0.;
float correction_factor = 0.98; // because the sample measured in the integrating sphere had a different surface structure

for (int iw = 0; iw < nsamples; iw++){
	wl = wstart + float(iw) * dw;
	cout << wl << ", ";
	averageR = averageR + fgg->Eval(wl) * fref->Eval(wl)*dw*correction_factor;
	norm = norm + fgg->Eval(wl)*dw;
}
cout << endl;
averageR = averageR/norm;

cout << "Average reflectivity is " << averageR << endl;
cout << "Check normalization " << fgg->Integral(320,600) << endl;

// print the arrays for use in Geant, sorted by energy

cout << "Energies: ";
for (int wl = nsamples-1; wl > 0; wl--) {
float energy = wavelengthToEnergy/(wstart + float(wl) * dw);
cout << energy << "*eV, ";
}
cout << endl;
cout << endl;
cout << "PEN spectrum: ";
for (int wl = nsamples-1; wl > 0; wl--) {
cout << tg_PENESpec2->Eval(wstart + float(wl) * dw) << ", ";
}
cout << endl;
cout << endl;
cout << "PEN reflectance: ";
for (int wl = nsamples-1; wl > 0; wl--) {
	float wll = wstart + float(wl) * dw;
	if (wll < 390)cout << fref->Eval(wll) << ", ";
	else cout << tg_PENESRRef->Eval(wll)/100. << ", ";
}
cout << endl;
cout << endl;
cout << "PMT efficiency: ";
for (int wl = nsamples-1; wl > 0; wl--) {
cout << tg_PMTQE->Eval(wstart + float(wl) * dw)*17./25. << ", "; // scale to the PMT that has max efficiency of 17%
}
cout << endl;
cout << endl;
cout << "absorption: ";
for (int wl = nsamples-1; wl > 0; wl--) {
cout <<  "0.01*cm, "; // 
}
cout << endl;

}